
// Simple PDF.js worker - local version
console.log('PDF.js local worker initializing...');

// Basic worker functionality for PDF.js
self.onmessage = function(e) {
  console.log('Worker received message:', e.data);
  
  // Basic message handling
  if (e.data && e.data.type) {
    switch (e.data.type) {
      case 'test':
        self.postMessage({
          type: 'test-response',
          success: true,
          message: 'Worker is ready'
        });
        break;
      default:
        console.log('Unknown message type:', e.data.type);
    }
  }
};

// Try to load the actual PDF.js worker functionality
try {
  // Import the worker from a reliable CDN
  importScripts('https://unpkg.com/pdfjs-dist@5.3.31/build/pdf.worker.min.js');
  console.log('PDF.js worker loaded successfully');
} catch (error) {
  console.error('Failed to load PDF.js worker, using fallback:', error);
  
  // Minimal fallback implementation
  self.onmessage = function(e) {
    console.warn('Using fallback worker - limited functionality');
    self.postMessage({
      type: 'error',
      message: 'PDF worker failed to load - please refresh the page'
    });
  };
}
